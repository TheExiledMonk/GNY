<!DOCTYPE html>
<html>
<head>
    <title>Logs - GNY DataWarehouse NexGen</title>
    <meta charset="utf-8">
</head>
<body style="margin:0;font-family:sans-serif;background:#f6f8fb;">
    {{ navbar|safe }}
    {{ menu|safe }}
    <div style="max-width:900px;margin:2.5em auto 0 auto;padding:2em 2.5em;background:#fff;border-radius:12px;box-shadow:0 2px 16px #0001;">
      <h2 style="margin-top:0; color:#1557a6;">System Logs</h2>
<form method="get" style="margin-bottom:1.2em;display:flex;gap:1.5em;align-items:end;flex-wrap:wrap;">
  <div>
    <label style="font-weight:500;color:#1557a6;">Level</label><br>
    <select name="level" style="padding:0.2em 0.7em;">
      <option value="">Any</option>
      {% for lvl in ["DEBUG","INFO","WARNING","ERROR","CRITICAL"] %}
        <option value="{{ lvl }}" {% if filters.level and filters.level.upper() == lvl %}selected{% endif %}>{{ lvl }}</option>
      {% endfor %}
    </select>
  </div>
  <div>
    <label style="font-weight:500;color:#1557a6;">Start</label><br>
    <input type="datetime-local" name="start" value="{{ filters.start }}" style="padding:0.2em 0.7em;" />
  </div>
  <div>
    <label style="font-weight:500;color:#1557a6;">End</label><br>
    <input type="datetime-local" name="end" value="{{ filters.end }}" style="padding:0.2em 0.7em;" />
  </div>
  <div>
    <label style="font-weight:500;color:#1557a6;">Search</label><br>
    <input type="text" name="q" value="{{ filters.q }}" placeholder="Keyword..." style="padding:0.2em 0.7em;min-width:180px;" />
  </div>
  <div>
    <button type="submit" style="background:#1557a6;color:#fff;padding:0.5em 1.7em;border:none;border-radius:4px;font-weight:bold;font-size:1.07em;cursor:pointer;">Filter</button>
  </div>
</form>
{% if filters.level or filters.start or filters.end or filters.q %}
  <div style="margin-bottom:1em;font-size:1.04em;color:#444;">Active filters:
    {% if filters.level %}<span style="background:#eaf1fb;padding:0.2em 0.7em;border-radius:4px;margin-right:0.7em;">Level: {{ filters.level|upper }}</span>{% endif %}
    {% if filters.start %}<span style="background:#eaf1fb;padding:0.2em 0.7em;border-radius:4px;margin-right:0.7em;">Start: {{ filters.start }}</span>{% endif %}
    {% if filters.end %}<span style="background:#eaf1fb;padding:0.2em 0.7em;border-radius:4px;margin-right:0.7em;">End: {{ filters.end }}</span>{% endif %}
    {% if filters.q %}<span style="background:#eaf1fb;padding:0.2em 0.7em;border-radius:4px;margin-right:0.7em;">Search: {{ filters.q }}</span>{% endif %}
  </div>
{% endif %}
<style>
  .log-info { color: #6ef57a; }
  .log-warning { color: #ffe066; }
  .log-error { color: #ffb2b2; }
  .log-critical, .log-fatal { color: #ff4444; font-weight:bold; }
</style>
<style>
  .log-info { color: #6ef57a; }
  .log-warning { color: #ffe066; }
  .log-error { color: #ffb2b2; }
  .log-critical, .log-fatal { color: #ff4444; font-weight:bold; }
</style>
<pre style="background:#222;color:#b5e0ff;font-family:monospace;font-size:1.01em;padding:1.2em 1em;border-radius:7px;max-height:540px;overflow-y:auto;white-space:pre-wrap;">
{% for line in logs %}{% if line.strip() %}{% set lower = line|lower %}{% if ' fatal ' in lower %}<span class="log-fatal">{{ line.rstrip('\n') }}</span>
{% elif ' critical ' in lower %}<span class="log-critical">{{ line.rstrip('\n') }}</span>
{% elif ' error ' in lower %}<span class="log-error">{{ line.rstrip('\n') }}</span>
{% elif ' warning ' in lower %}<span class="log-warning">{{ line.rstrip('\n') }}</span>
{% elif ' info ' in lower %}<span class="log-info">{{ line.rstrip('\n') }}</span>
{% else %}<span>{{ line.rstrip('\n') }}</span>
{% endif %}{% endif %}{% endfor %}</pre>
    </div>
</body>
</html>
